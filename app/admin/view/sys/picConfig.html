{extend name="public/base" /}
{block name="ajax-content"}
	<div class="page-header">
		<h1>
			系统管理
			<small>
				<i class="ace-icon fa fa-angle-double-right"></i>
				图片上传配置
			</small>
		</h1>
	</div><!-- /.page-header -->
	<form class="form-horizontal ajax-form" method="post" action="{:url('admin/Sys/savePicConfig')}">
	<input type="hidden" name='id' value="{$pic_config.id|default=''}" />
	<div class="row margintop">
		<div class="col-xs-12">
			<div class="form-group">
				<label class="col-sm-3 control-label no-padding-right">是否开启水印 </label>
				<div class="help-inline col-sm-6">
					<label class="col-sm-2">
						<input class="ace ace-switch ace-switch-4 btn-rotate" id="is_water" name="is_water" type="checkbox" value="1" {if condition="$pic_config.is_water eq 1"}checked="checked"{/if}>
						<span class="lbl"></span>
					</label>
					<span class="col-xs-6">
						<span class="middle">默认不启用</span>
					</span>							
				</div>
			</div>
			<div id="water_enabled" {if condition="!isset($pic_config.is_water) OR ($pic_config.is_water eq 0)"}style="display:none"{/if}>
				<div class="space-4"></div>	
				<div class="form-group">
					<label class="col-sm-3 control-label no-padding-right">水印位置</label>
					<div class="col-sm-5"> 
						<div class="btn-group" data-toggle="buttons">
							<label class="btn radio-btn click-type {notempty name='pic_config.water_data.local'}{if condition='$pic_config.water_data.local ==1'}btn-success active{else/} btn-info{/if}{/notempty}">
								<input type="radio" value='1' {notempty name='pic_config.water_data.local'}{if condition="$pic_config.water_data.local ==1"}checked='checked'{/if}{/notempty} name="water_local">
								左上角水印
							</label>
							<label class="btn radio-btn click-type {notempty name='pic_config.water_data.local'}{if condition='$pic_config.water_data.local ==2'}btn-success active{else/} btn-info{/if}{/notempty}">
								<input type="radio" value='2' {notempty name='pic_config.water_data.local'}{if condition="$pic_config.water_data.local ==2"}checked='checked'{/if}{/notempty} name="water_local">
								上居中水印
							</label>
							<label class="btn radio-btn click-type {notempty name='pic_config.water_data.local'}{if condition='$pic_config.water_data.local ==3'}btn-success active{else/} btn-info{/if}{/notempty}">
								<input type="radio" value='3' {notempty name='pic_config.water_data.local'}{if condition="$pic_config.water_data.local ==3"}checked='checked'{/if}{/notempty} name="water_local">
								右上角水印
							</label>	
							<label class="btn radio-btn click-type {notempty name='pic_config.water_data.local'}{if condition='$pic_config.water_data.local ==4'}btn-success active{else/} btn-info{/if}{/notempty}">
								<input type="radio" value='4' {notempty name='pic_config.water_data.local'}{if condition="$pic_config.water_data.local ==4"}checked='checked'{/if}{/notempty} name="water_local">
								左居中水印
							</label>
							<label class="btn radio-btn click-type {notempty name='pic_config.water_data.local'}{if condition='$pic_config.water_data.local ==5'}btn-success active{else/} btn-info{/if}{/notempty}">
								<input type="radio" value='5' {notempty name='pic_config.water_data.local'}{if condition="$pic_config.water_data.local ==5"}checked='checked'{/if}{/notempty} name="water_local">
								居中水印
							</label>
							<label class="btn radio-btn click-type {notempty name='pic_config.water_data.local'}{if condition='$pic_config.water_data.local ==6'}btn-success active{else/} btn-info{/if}{/notempty}">
								<input type="radio" value='6' {notempty name='pic_config.water_data.local'}{if condition="$pic_config.water_data.local ==6"}checked='checked'{/if}{/notempty} name="water_local">
								右居中水印
							</label>	
							<label class="btn radio-btn click-type {notempty name='pic_config.water_data.local'}{if condition='$pic_config.water_data.local ==7'}btn-success active{else/} btn-info{/if}{/notempty}">
								<input type="radio" value='7' {notempty name='pic_config.water_data.local'}{if condition="$pic_config.water_data.local ==7"}checked='checked'{/if}{/notempty} name="water_local">
								左下角水印
							</label>
							<label class="btn radio-btn click-type {notempty name='pic_config.water_data.local'}{if condition='$pic_config.water_data.local ==8'}btn-success active{else/} btn-info{/if}{/notempty}">
								<input type="radio" value='8' {notempty name='pic_config.water_data.local'}{if condition="$pic_config.water_data.local ==8"}checked='checked'{/if}{/notempty} name="water_local">
								下居中水印
							</label>
							<label class="btn radio-btn click-type {notempty name='pic_config.water_data.local'}{if condition='$pic_config.water_data.local ==9'}btn-success active{else/} btn-info{/if}{/notempty}">
								<input type="radio" value='9' {notempty name='pic_config.water_data.local'}{if condition="$pic_config.water_data.local ==9"}checked='checked'{/if}{/notempty} name="water_local">
								右下角水印
							</label>																											
						</div>			     																																																					
					</div>
				</div>		
				<div class="space-4"></div>	
				<div class="form-group">
					<label class="col-sm-3 control-label no-padding-right">水印类型 </label>
					<div class="col-sm-6">
						<div class="btn-group" data-toggle="buttons">
							<label class="btn radio-btn water-type {if condition='$pic_config.water_type ==1'}btn-success active{else/} btn-info{/if}">
								<input type="radio" value='img' {if condition="$pic_config.water_type ==1"}checked='checked'{/if} name="img_or_text">
								图片水印
							</label>
							<label class="btn radio-btn water-type {if condition='$pic_config.water_type ==2'}btn-success active{else/} btn-info{/if}">
								<input type="radio" value='text' {if condition="$pic_config.water_type ==2"}checked='checked'{/if} name="img_or_text">
								文字水印
							</label>						
						</div>							
					</div>
				</div>	
				<div id="img_water" {if condition ="$pic_config.water_type!=1"}style="display:none"{/if}>
					<div class="space-4"></div>	
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right">水印图片</label>
						<div class="col-sm-9">
							<input type="hidden" name="old_water_img" value="{$pic_config.water_data.img_url|default=''}"/>
							<input type="hidden" name="water_img" id="water_img" value="{$pic_config.water_data.img_url|default=''}"/>
					        <img id="water_img_src" class="col-sm-3 img-responsive crop-img" data-input-id='water_img' data-src-id='water_img_src' src="{$pic_config.water_data.img_url|default=default_img()}" data-rel="tooltip" title="点击上传图片">
							<span class="help-inline col-xs-12 col-sm-5">
								<span class="middle">建议水印图片大小不超过100K</span>
							</span>								
						</div>
					</div>	
					<div class="space-4"></div>	
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right">透明度</label>
						<div class="col-sm-9">
							<input type="text" name="alpha" value="{$pic_config.water_data.alpha|default='100'}" placeholder="透明度" class="col-xs-8" pattern="[0-9]{1,3}" title='只允许最多3位数字' required/>
							<span class="help-inline col-xs-4">
								<span class="middle">默认100不透明；0为透明</span>
							</span>																																																							
						</div>
					</div>				
				</div>
				<div id="text_water" {if condition ="$pic_config.water_type!=2"}style="display:none"{/if}>
					<div class="space-4"></div>	
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right">文字</label>
						<div class="col-sm-9">
							<textarea name="text" id="text" cols="20" rows="3" class="col-xs-8 limited" placeholder="最多200个字符" maxlength="200">{$pic_config.water_data.text|default=''}</textarea>
							<span class="help-inline col-xs-4">
								还可以输入 <span class="middle red charsLeft"></span> 个字符
							</span>																																																						
						</div>
					</div>		
					<div class="space-4"></div>	
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right">字体类型 </label>
						<div class="col-sm-6">
							<div class="btn-group" data-toggle="buttons">
								{volist name="Think.config.extarray.font_type" id="font_info"}
								<label class="btn radio-btn font-type {notempty name='pic_config.water_data.font_code'}{if condition='$pic_config.water_data.font_code ==$font_info.code'}btn-success active{else/} btn-info{/if}{/notempty}">
									<input type="radio" value="{$font_info.code}" {notempty name='pic_config.water_data.font_code'}{if condition="$pic_config.water_data.font_code ==$font_info['code']"}checked='checked'{/if}{/notempty} name="font">
									{$font_info.title}
								</label>
								{/volist}						
							</div>							
						</div>
					</div>	
					<div class="space-4"></div>	
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right">字体大小</label>
						<div class="col-sm-9">
							<input type="text" name="size" value="{$pic_config.water_data.size|default='20'}" placeholder="字体大小" class="col-xs-8" pattern="[0-9]{1,3}" title='只允许最多3位数字' required/>
							<span class="help-inline col-xs-4">
								<span class="middle red">默认20px</span>
							</span>																																																							
						</div>
					</div>	
					<div class="space-4"></div>	
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right">字体颜色</label>
						<div class="col-sm-9">
							<div id="color_picker" class="input-group col-sm-8 colorpicker-component"> 
								<input type="text" name='color' value="{$pic_config.water_data.color|default='#000000'}" readonly class="form-control"/> 
								<span class="input-group-addon"><i></i></span> 
							</div>	
						</div>				
					</div>	
					<div class="space-4"></div>	
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right">文字倾斜角度</label>
						<div class="col-sm-9">
							<input type="text" name="angle" value="{$pic_config.water_data.angle|default='0'}" placeholder="文字倾斜角度" class="col-xs-8" pattern="[0-9]{1,3}" title='只允许最多3位数字' required/>
							<span class="help-inline col-xs-4">
								<span class="middle red">默认水平</span>
							</span>																																																							
						</div>
					</div>				
				</div>																		
	    	</div>
			<div class="space-4"></div>	
			<div class="form-group">
				<label class="col-sm-3 control-label no-padding-right">略缩图最大宽高</label>
				<div class="col-sm-9">
					<div class="input-daterange col-sm-8 input-group">
						<span class="input-group-addon">
						宽（单位px【像素】）
						</span>					
						<input class="form-control" name="max_width" value="{$pic_info.thumb_data.max_width|default='150'}" pattern="[0-9]{1,3}" title='只允许最多3位数字' type="text">
						<span class="input-group-addon">
						高（单位px【像素】）
						</span>							
						<input class="form-control" name="max_height" value="{$pic_info.thumb_data.max_height|default='150'}" pattern="[0-9]{1,3}" title='只允许最多3位数字' type="text">
					</div>																																																						
				</div>
			</div>
			<div class="space-4"></div>	
			<div class="form-group">
				<label class="col-sm-3 control-label no-padding-right">略缩图类型</label>
				<div class="col-sm-5"> 
					<div class="btn-group" data-toggle="buttons">
						<label class="btn radio-btn thumb-type {notempty name='pic_config.thumb_data.thumb_type'}{if condition='$pic_config.thumb_data.thumb_type ==1'}btn-success active{else/} btn-info{/if}{/notempty}">
							<input type="radio" value='1' {notempty name='pic_config.thumb_data.thumb_type'}{if condition="$pic_config.thumb_data.thumb_type ==1"}checked='checked'{/if}{/notempty} name="thumb_type">
							缩略图等比例缩放
						</label>
						<label class="btn radio-btn thumb-type {notempty name='pic_config.thumb_data.thumb_type'}{if condition='$pic_config.thumb_data.thumb_type ==2'}btn-success active{else/} btn-info{/if}{/notempty}">
							<input type="radio" value='2' {notempty name='pic_config.thumb_data.thumb_type'}{if condition="$pic_config.thumb_data.thumb_type ==2"}checked='checked'{/if}{/notempty} name="thumb_type">
							缩略图缩放后填充
						</label>
						<label class="btn radio-btn thumb-type {notempty name='pic_config.thumb_data.thumb_type'}{if condition='$pic_config.thumb_data.thumb_type ==3'}btn-success active{else/} btn-info{/if}{/notempty}">
							<input type="radio" value='3' {notempty name='pic_config.thumb_data.thumb_type'}{if condition="$pic_config.thumb_data.thumb_type ==3"}checked='checked'{/if}{/notempty} name="thumb_type">
							缩略图居中裁剪
						</label>	
						<label class="btn radio-btn thumb-type {notempty name='pic_config.thumb_data.thumb_type'}{if condition='$pic_config.thumb_data.thumb_type ==4'}btn-success active{else/} btn-info{/if}{/notempty}">
							<input type="radio" value='4' {notempty name='pic_config.thumb_data.thumb_type'}{if condition="$pic_config.thumb_data.thumb_type ==4"}checked='checked'{/if}{/notempty} name="thumb_type">
							缩略图左上角裁剪
						</label>
						<label class="btn radio-btn thumb-type {notempty name='pic_config.thumb_data.thumb_type'}{if condition='$pic_config.thumb_data.thumb_type ==5'}btn-success active{else/} btn-info{/if}{/notempty}">
							<input type="radio" value='5' {notempty name='pic_config.thumb_data.thumb_type'}{if condition="$pic_config.thumb_data.thumb_type ==5"}checked='checked'{/if}{/notempty} name="thumb_type">
							缩略图右下角裁剪
						</label>	
						<label class="btn radio-btn thumb-type {notempty name='pic_config.thumb_data.thumb_type'}{if condition='$pic_config.thumb_data.thumb_type ==6'}btn-success active{else/} btn-info{/if}{/notempty}">
							<input type="radio" value='6' {notempty name='pic_config.thumb_data.thumb_type'}{if condition="$pic_config.thumb_data.thumb_type ==6"}checked='checked'{/if}{/notempty} name="thumb_type">
							缩略图固定尺寸缩放
						</label>																																	
					</div>			     																																																					
				</div>
			</div>						    	
			<div class="clearfix form-actions">
				<div class="col-sm-offset-6 col-sm-5">
					<button class="btn btn-info" type="submit">
						<i class="ace-icon fa fa-check bigger-110"></i>
						保存
					</button>
				</div>
			</div>																													
		</div>		
	</div> 
	</form>
	{include file="file_upload/fileModal" /}
	<link href="__PUBLIC_PC__/ace/components/mjolnic-bootstrap-colorpicker/dist/css/bootstrap-colorpicker.min.css" rel="stylesheet" />
	<script type="text/javascript">
	$.getScript('__PUBLIC_PC__/ace/components/mjolnic-bootstrap-colorpicker/dist/js/bootstrap-colorpicker.min.js',function(){
		$('#color_picker').colorpicker({
			 color: "#000000", 
			 format: "hex"
		});
	})
	$("body").delegate('.water-type','click',function(){
		$(".water-type").addClass('btn-info').removeClass('btn-success');
		$(this).addClass('btn-success').removeClass('btn-info');
		$(".water-type").children("input[type='radio']").attr("checked",false);
		$(this).children("input[type='radio']").attr("checked",true);
		var water_type=$(this).children("input[type='radio']").val();
		if(water_type=='img'){
			$("#img_water").show(200);
			$("#text_water").hide(200);
		}
		else if(water_type=='text'){
			$("#img_water").hide(200);
			$("#text_water").show(200);
		}
	})
	$("body").delegate('.click-type','click',function(){
		$(".click-type").addClass('btn-info').removeClass('btn-success');
		$(this).addClass('btn-success').removeClass('btn-info');
		$(".click-type").children("input[type='radio']").attr("checked",false);
		$(this).children("input[type='radio']").attr("checked",true);
	})
	$("body").delegate('.font-type','click',function(){
		$(".font-type").addClass('btn-info').removeClass('btn-success');
		$(this).addClass('btn-success').removeClass('btn-info');
		$(".font-type").children("input[type='radio']").attr("checked",false);
		$(this).children("input[type='radio']").attr("checked",true);
	})
	$("body").delegate('.thumb-type','click',function(){
		$(".thumb-type").addClass('btn-info').removeClass('btn-success');
		$(this).addClass('btn-success').removeClass('btn-info');
		$(".thumb-type").children("input[type='radio']").attr("checked",false);
		$(this).children("input[type='radio']").attr("checked",true);
	})	
	$("body").delegate('#is_water','click',function(){  
		if($(this).is(':checked')){
			$("#water_enabled").show(200);
		}
		else{
			$("#water_enabled").hide(200);
		}
	})
	</script>
{/block}	    	